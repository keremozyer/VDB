using System;
using System.Collections.Generic;
using VDB.MicroServices.VulnerabilityDetector.Model.Exchange._Common;

namespace VDB.MicroServices.VulnerabilityDetector.Model.Exchange.Report.GetReport
{
    public record GetReportResponseModel
    {
        /// <summary>
        /// Reports id.
        /// </summary>
        public Guid ID { get; set; }
        /// <summary>
        /// If report creation has been started this field will hold the date system scanned cve data and product catalog.
        /// </summary>
        public DateTime? ReportCreationDate { get; set; }
        /// <summary>
        /// Reports status. Can be { { "WAIT": "Waiting for scan" }, { "PROC": "Scanning right now" }, { "CMP": "Completed" }, { "ERR", "An error occurred during report creation" } }
        /// </summary>
        public string ReportStatus { get; set; }
        /// <summary>
        /// If an error occurred during report creation this field will hold the error message.
        /// </summary>
        public string ErrorMessage { get; set; }
        /// <summary>
        /// List of report contents.
        /// </summary>
        public IEnumerable<ReportContentData> Contents { get; set; }
    }

    public record ReportContentData
    {
        /// <summary>
        /// Product version with CVE data.
        /// </summary>
        public ProductVersionData ProductVersion { get; set; }
        /// <summary>
        /// CVE matches of this product versions.
        /// </summary>
        public IEnumerable<CVEMatchData> CVEMatches { get; set; }
        /// <summary>
        /// List of servers containing this product version.
        /// </summary>
        public IEnumerable<ServerData> Servers { get; set; }
    }
}
