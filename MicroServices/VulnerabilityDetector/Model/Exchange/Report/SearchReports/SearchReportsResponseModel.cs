using System;
using System.Collections.Generic;

namespace VDB.MicroServices.VulnerabilityDetector.Model.Exchange.Report.SearchReports
{
    public record SearchReportsResponseModel
    {
        /// <summary>
        /// Total item count of reports suiting search criterias. Used for paging.
        /// </summary>
        public int TotalItemCount { get; set; }
        /// <summary>
        /// List of reports.
        /// </summary>
        public List<VulnerabilityReportData> Reports { get; set; }
    }

    public record VulnerabilityReportData
    {
        /// <summary>
        /// ID of report.
        /// </summary>
        public Guid ID { get; set; }
        /// <summary>
        /// If report creation has been started this field will hold the date system scanned cve data and product catalog.
        /// </summary>
        public DateTime? ReportCreationDate { get; set; }
        /// <summary>
        /// Indicates this scan is completed, found some records and created a report document.
        /// </summary>
        public bool HasDocument { get; set; }
        /// <summary>
        /// Reports status. Can be { { "WAIT": "Waiting for scan" }, { "PROC": "Scanning right now" }, { "CMP": "Completed" }, { "ERR", "An error occurred during report creation" } }
        /// </summary>
        public string ReportStatus { get; set; }
        /// <summary>
        /// If an error occurred during report creation this field will hold the error message.
        /// </summary>
        public string ErrorMessage { get; set; }
    }
}
