using AutoMapper;
using System;

namespace VDB.MicroServices.VulnerabilityDetector.Manager.Mapper._AutoMapperProfiles
{
    public class VulnerabilityDetectorMappingProfile : Profile
    {
        public VulnerabilityDetectorMappingProfile()
        {
            CreateMap<ExternalData.Model.ProductCatalog.GetCatalog.GetCatalogResponseModel, Model.DTO.ProductCatalog.Catalog>();
            CreateMap<ExternalData.Model.ProductCatalog.GetCatalog.ProductData, Model.DTO.ProductCatalog.ProductData>();
            CreateMap<ExternalData.Model.ProductCatalog.GetCatalog.ProductVersionData, Model.DTO.ProductCatalog.ProductVersionData>();
            CreateMap<ExternalData.Model.ProductCatalog.GetCatalog.ServerData, Model.DTO.ProductCatalog.ServerData>();
            CreateMap<ExternalData.Model.ProductCatalog.GetCatalog.VendorData, Model.DTO.ProductCatalog.VendorData>();

            CreateMap<ExternalData.Model.CVEData.SearchByProductVersion.SearchByProductVersionResponseModel, Model.DTO._CVEData.ProductCVEData>();
            CreateMap<ExternalData.Model.CVEData.SearchByProductVersion.CVEData, Model.DTO._CVEData.CVEData>();
            CreateMap<ExternalData.Model.CVEData.SearchByProductVersion.CVEMatchType, Model.DTO._CVEData.CVEMatchType>();
            CreateMap<ExternalData.Model.CVEData.SearchByProductVersion.ProductData, Model.DTO._CVEData.CVEProductData>();

            CreateMap<Model.Entity.VulnerabilityReport, Model.Exchange.Report.SearchReports.VulnerabilityReportData>().ForMember(d => d.HasDocument, o => o.MapFrom(s => !String.IsNullOrWhiteSpace(s.Base64ReportData)));

            CreateMap<Model.Entity.VulnerabilityReport, Model.Exchange.Report.GetReport.GetReportResponseModel>();
            CreateMap<Model.Entity.ReportContent, Model.Exchange.Report.GetReport.ReportContentData>();
            CreateMap<Model.Entity.ProductVersion, Model.Exchange._Common.ProductVersionData>();
            CreateMap<Model.Entity.Product, Model.Exchange._Common.ProductData>();
            CreateMap<Model.Entity.Vendor, Model.Exchange._Common.VendorData>();
            CreateMap<Model.Entity.CVEMatch, Model.Exchange._Common.CVEMatchData>();
            CreateMap<Model.Entity.CVE, Model.Exchange._Common.CVEData>();            
            CreateMap<Model.Entity.Server, Model.Exchange._Common.ServerData>();
        }
    }
}
