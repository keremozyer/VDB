using Microsoft.Extensions.Options;
using System.Net.Http;
using System.Threading.Tasks;
using VDB.MicroServices.CVEData.Concern.Options;

namespace VDB.MicroServices.CVEData.ExternalData.Manager.Service.VulnerabilityReport
{
    public class VulnerabilityReportServiceManager : IVulnerabilityReportServiceManager
    {
        private readonly VulnerabilityDetectorSettings VulnerabilityDetectorSettings;
        private readonly HttpClient HttpClient;

        public VulnerabilityReportServiceManager(IOptions<EndpointSettings> endpointSettings, HttpClient httpClient)
        {
            this.VulnerabilityDetectorSettings = endpointSettings.Value.VulnerabilityDetector;
            this.HttpClient = httpClient;
        }

        public async Task CreateReport()
        {
            HttpResponseMessage httpResponse = await this.HttpClient.PostAsync(this.VulnerabilityDetectorSettings.CreateReportEndpoint, null);
            httpResponse.EnsureSuccessStatusCode();            
        }
    }
}
